{% set data = data or {} %}
{% set errors = errors or {} %}
{% set onepage = onepage or 0 %}

{% set group_name = 'groups__%s__id' % data.groups|length %}

    {% set available_groups = h.list_of_all_groups() %}
  <div id="select_country" class="control-group">
      {% set error = errors.groups_list %}
      <p>{{ _("Which country or countries does the dataset best represent?") }}</p>
      {# <label class="control-label" for="field-group">{{ _("Add Group") }}</label> #}
    <div class="controls">
      {% if onepage == 1 %}
        <select id="country-drop">
      {% else %}
        <select id="field-group" name="{{ group_name }}" multiple>
      {% endif %}
          <option value="-1">{{ _("Country / Countries") }}</option>
          {% for grp in available_groups  %}
            <option value="{{ grp.id }}" display_name="{{grp.display_name}}">{{ grp.display_name }}</option>
          {% endfor %}
        </select>
        {% if error %}<span class="error-block">{{ error }}</span>{% endif %}
      </div>
  </div>

<div class="control-group">
        <div id="selected_groups" class="controls">
  {% if data.groups %}
          {% for group in data.groups %}
            {% if group.id != '-1' %}
          <span class="filtered pill">{{group.title}} <input id="field-group-{{ loop.index0 }}" type="checkbox" name="groups__{{loop.index0}}__id" value="{{group.id}}" checked="checked" class="group_checked"/></span>
          {% endif %}
          {% endfor %}
    {% endif %}
  </div>
      </div>